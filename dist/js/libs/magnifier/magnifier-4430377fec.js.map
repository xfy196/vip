{"version":3,"sources":["libs/magnifier/magnifier.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","$","magnifier","container","containerImg","view","width","height","moveView","moveWidth","zoom","thumbnail","assembly","index","window","magnifierAttr","n","_this","find","boxMoveViewWidth","boxMoveViewHeight","deviationXl","deviationXr","deviationYt","deviationYb","imgWidth","imgHieght","multiple","imgBox","css","eqImg","img","Image","src","eq","attr","removeClass","addClass","imgLoadEnd","styleCss","onload","empty","append","moveFn","e","X","clientX","offset","left","Y","clientY","top","document","scrollTop","endX","endY","display","positionX","positionY","margin-left","margin-top","on","hide","thumbnailImg","lineLenght","length","imgMove","_boole","_deviation","Math","ceil","endLeft","this","setIndex","jQuery"],"mappings":"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","file":"magnifier-4430377fec.js","sourcesContent":["\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function ($) {\n  var fnName = 'magnifier';\n  var magnifier = {\n    magnifier: \".magnifier\",\n    //最外层的大容器\n    container: \".magnifier-container\",\n    //选择当前主图的承载容器\n    containerImg: '.images-cover',\n    //图片的容器\n    view: \".magnifier-view\",\n    //图片放大后承载容器\n    width: 400,\n    //图片放大后承载容器宽度\n    height: 400,\n    //图片放大后承载容器高度\n    moveView: \".move-view\",\n    //跟随鼠标移动的容器\n    moveWidth: null,\n    //如果设置了移动盒子的宽度，则不计算缩放比例\n    zoom: 4,\n    //缩放比例\n    thumbnail: \".magnifier-line > ul\",\n    //缩略图容器\n    assembly: \".magnifier-btn\",\n    //按钮组\n    index: 0 //当前图片的索引\n\n  };\n\n  window[fnName] = function (magnifierAttr) {\n    //设置属性值\n    if (_typeof(magnifierAttr) == \"object\") {\n      for (var n in magnifierAttr) {\n        magnifier[n] = magnifierAttr[n];\n      }\n    }\n\n    var _this = window; //绑定容器\n\n    _this.magnifier = $(magnifier.magnifier);\n    _this.container = _this.magnifier.find(magnifier.container);\n    _this.view = _this.magnifier.find(magnifier.view);\n    _this.moveView = _this.magnifier.find(magnifier.moveView);\n    _this.thumbnail = _this.magnifier.find(magnifier.thumbnail);\n    _this.assembly = _this.magnifier.find(magnifier.assembly);\n    _this.containerImg = _this.magnifier.find(magnifier.containerImg);\n    var imgBox = _this.containerImg; //設置寬高\n\n    _this.magnifier.css({\n      \"width\": magnifier.width\n    });\n\n    _this.container.css({\n      \"width\": magnifier.width,\n      \"height\": magnifier.height\n    });\n\n    _this.view.css({\n      \"width\": magnifier.width,\n      \"height\": magnifier.height\n    });\n\n    var boxMoveViewWidth, boxMoveViewHeight;\n\n    if (magnifier.moveWidth) {\n      boxMoveViewWidth = magnifier.moveWidth;\n    } else {\n      boxMoveViewWidth = magnifier.width / magnifier.zoom;\n    }\n\n    boxMoveViewHeight = boxMoveViewWidth;\n\n    _this.moveView.css({\n      \"width\": boxMoveViewWidth,\n      \"height\": boxMoveViewHeight\n    }); //计算体积碰撞的变量\n\n\n    var deviationXl, deviationXr, deviationYt, deviationYb, imgWidth, imgHieght, multiple;\n\n    _this.eqImg = function () {\n      var img = new Image(),\n          src = _this.thumbnail.find(\"img\").eq(magnifier.index).attr('src');\n\n      img.src = src; //承载容器的宽高\n\n      var containerWidth = magnifier.width;\n      var containerHeight = magnifier.height;\n\n      _this.thumbnail.find('>*').removeClass('active').eq(magnifier.index).addClass('active');\n\n      function imgLoadEnd() {\n        if (img.width == 0) {\n          img.onload = imgLoadEnd;\n        }\n\n        var styleCss;\n\n        if (img.width > img.height) {\n          imgWidth = magnifier.width;\n          imgHieght = img.height / (img.width / magnifier.width);\n          styleCss = \"top:50%;margin-top:\" + -imgHieght / 2 + \"px\";\n        } else {\n          imgWidth = img.width / (img.height / magnifier.width);\n          imgHieght = magnifier.width;\n          styleCss = \"left:50%;margin-left:\" + -imgWidth / 2 + \"px\";\n        }\n\n        imgBox.empty().append('<img src=\"' + src + '\" width=\"' + imgWidth + '\" height=\"' + imgHieght + '\" style=\"' + styleCss + '\" />'); //重新计算移动盒子与图片的倍数\n\n        multiple = magnifier.width / boxMoveViewWidth; //容器加载图片\n\n        _this.view.empty().append('<img src=\"' + src + '\" width=\"' + imgWidth * multiple + '\" height=\"' + imgHieght * multiple + '\" />'); //偏移量\n\n\n        deviationXl = (magnifier.width - imgWidth) / 2;\n        deviationXr = magnifier.width - deviationXl - boxMoveViewWidth + 1; //这里额外+1的是要计算容器的左边框\n\n        deviationYt = (magnifier.height - imgHieght) / 2;\n        deviationYb = magnifier.height - deviationYt - boxMoveViewHeight + 1; //这里额外+1的是要计算容器的上边框\n      }\n\n      imgLoadEnd();\n    }; //完成后执行\n\n\n    _this.eqImg();\n\n    _this.moveFn = function (e) {\n      var X = e.clientX - _this.magnifier.offset().left - boxMoveViewWidth / 2,\n          Y = e.clientY - _this.magnifier.offset().top + $(document).scrollTop() - boxMoveViewHeight / 2;\n      var endX = X > deviationXl ? X < deviationXr ? X : deviationXr : deviationXl;\n      var endY = Y > deviationYt ? Y < deviationYb ? Y : deviationYb : deviationYt; //当Y轴超出容器\n\n      endY = endY > 0 ? endY > magnifier.width - boxMoveViewHeight ? magnifier.height - boxMoveViewHeight : endY : 0;\n\n      _this.moveView.css({\n        'left': endX,\n        'top': endY,\n        'display': \"block\"\n      });\n\n      var positionX = (endX - (magnifier.width - imgWidth) / 2) * multiple;\n      var positionY = (endY - (magnifier.height - imgHieght) / 2) * multiple;\n\n      _this.view.css({\n        'display': \"block\"\n      }).find('img').css({\n        'margin-left': -positionX,\n        'margin-top': -positionY\n      });\n    };\n\n    _this.container.on('mousemove', function (e) {\n      _this.moveFn(e);\n    }).on('mouseleave', function () {\n      _this.moveView.hide();\n\n      _this.view.hide();\n    });\n\n    var thumbnailImg = _this.thumbnail.find('>*'),\n        lineLenght = thumbnailImg.length;\n\n    _this.imgMove = function (_boole) {\n      _boole ? magnifier.index++ : magnifier.index--;\n\n      var _deviation = Math.ceil(magnifier.width / thumbnailImg.width() / 2);\n\n      if (lineLenght < _deviation) {\n        return false;\n      }\n\n      magnifier.index < 0 ? magnifier.index = 0 : magnifier.index > lineLenght - _deviation ? magnifier.index = lineLenght - _deviation : magnifier.index;\n      var endLeft = thumbnailImg.width() * magnifier.index - thumbnailImg.width();\n\n      _this.thumbnail.css({\n        \"left\": (endLeft > 0 ? -endLeft : 0) + \"px\"\n      });\n    }; //按钮组动作\n\n\n    _this.assembly.find(\">*\").on('click', function () {\n      _this.imgMove($(this).index());\n    });\n\n    thumbnailImg.on('click', function () {\n      magnifier.index = $(this).index(); //显示图片\n\n      _this.eqImg(); //缩略图位置移动\n      // _this.imgMove(magnifier.index);\n\n    });\n\n    _this.setIndex = function (n) {\n      magnifier.index = n ? n : 0;\n    };\n\n    return _this;\n  };\n})(jQuery);"]}