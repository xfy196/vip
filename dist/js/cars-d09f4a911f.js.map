{"version":3,"sources":["cars.js"],"names":["$","Car","eles","this","ordersEle","extend","prototype","init","initCars","update","carData","carsList","id","localStorage","setItem","JSON","stringify","renderData","delete","productId","parse","getItem","bindEvent","that","on","numAdd","num","Number","numInput","val","parents","find","numReduce","deleteBtn","bindImageHover","hover","addClass","removeClass","renderCarData","html","attr","concat","images","longTitle","size","promotion_price","max_market_price","notAllowedCheck","renderTotalPrice","totalNum","totalPrice","css","cursor","callbacks","Callbacks","add","userInfo","cookie","undefined","user","username","checkLogin","e","preventDefault","returnValue","removeCookie","location","reload","fire","jQuery"],"mappings":"AAAA,cAKA,SAAWA,GAIT,SAASC,EAAIC,GACXC,KAAKD,KAAOA,EACZC,KAAKC,UAAYJ,EAAEE,EAAKE,WAG1BJ,EAAEK,OAAOJ,EAAIK,UAAW,CACtBC,KAAM,WACJJ,KAAKK,YAOPC,OAAQ,SAAgBC,GACtBP,KAAKQ,SAASD,EAAQE,IAAMF,EAC5BG,aAAaC,QAAQ,OAAQC,KAAKC,UAAUb,KAAKQ,WACjDR,KAAKc,cAEPC,OAAU,SAAiBC,UAClBhB,KAAKQ,SAASQ,GACrBN,aAAaC,QAAQ,OAAQC,KAAKC,UAAUb,KAAKQ,WACjDR,KAAKc,cAMPT,SAAU,WACRL,KAAKQ,SAAWI,KAAKK,MAAMP,aAAaQ,QAAQ,UAAY,GAC5DlB,KAAKc,aACLd,KAAKmB,aAEPA,UAAW,WACT,IAAIC,EAAOpB,KAEXA,KAAKC,UAAUoB,GAAG,QAASD,EAAKrB,KAAKuB,OAAQ,WAE3C,IAAIC,EAAMC,OAAO3B,EAAEuB,EAAKrB,KAAK0B,UAAUC,OAEnCV,EAAYnB,EAAEG,MAAM2B,QAAQ,MAAMC,KAAK,yBAAyBF,MACpEH,IACA1B,EAAEuB,EAAKrB,KAAK0B,UAAUC,IAAIH,GAE1B,IAAIhB,EAAUa,EAAKZ,SAASQ,GAC5BT,EAAQgB,IAAMA,EAEdH,EAAKd,OAAOC,KAGdP,KAAKC,UAAUoB,GAAG,QAASD,EAAKrB,KAAK8B,UAAW,WAE9C,IAAIN,EAAMC,OAAO3B,EAAEuB,EAAKrB,KAAK0B,UAAUC,OAEnCV,EAAYnB,EAAEG,MAAM2B,QAAQ,MAAMC,KAAK,yBAAyBF,MAGpE,GAAY,KAFZH,EAGE,OAAO,EAGT1B,EAAEuB,EAAKrB,KAAK0B,UAAUC,IAAIH,GAE1B,IAAIhB,EAAUa,EAAKZ,SAASQ,GAC5BT,EAAQgB,IAAMA,EACdH,EAAKd,OAAOC,KAMdP,KAAKC,UAAUoB,GAAG,QAASD,EAAKrB,KAAK+B,UAAW,WAC9C,IAAId,EAAYnB,EAAEG,MAAM2B,QAAQ,MAAMC,KAAK,yBAAyBF,MACpEN,EAAa,OAAEJ,MAGnBe,eAAgB,WACdlC,EAAE,gBAAgBmC,MAAM,WACtBnC,EAAE,iCAAiCoC,SAAS,0BAC3C,WACDpC,EAAE,iCAAiCqC,YAAY,4BAGnDC,cAAe,WACb,IAAI5B,EAAUP,KAAKQ,SACf4B,EAAO,GAEX,IAAK,IAAIC,KAAQ9B,EACf6B,GAAQ,yFAAgGE,OAAOD,EAAM,sVAAoWC,OAAO/B,EAAQ8B,GAAME,OAAO,GAAI,+UAAyVD,OAAO/B,EAAQ8B,GAAME,OAAO,GAAI,oDAAsDD,OAAO/B,EAAQ8B,GAAMG,UAAW,gXAAqYF,OAAO/B,EAAQ8B,GAAMG,UAAW,4FAA6GF,OAAO/B,EAAQ8B,GAAMI,KAAM,mcAAmeH,OAAO/B,EAAQ8B,GAAMK,gBAAiB,6KAAsLJ,OAAO/B,EAAQ8B,GAAMM,iBAAkB,wfAA4iBL,OAAO/B,EAAQ8B,GAAMd,IAAK,qiBAAujBe,OAAO/B,EAAQ8B,GAAMK,gBAAkBnC,EAAQ8B,GAAMd,IAAK,4PAGp5GvB,KAAKC,UAAUmC,KAAKA,GACpBpC,KAAK4C,mBAEPC,iBAAkB,WAChB,IAAIT,EAAO,GACPU,EAAW,EACXC,EAAa,EAEjB,IAAK,IAAIV,KAAQrC,KAAKQ,SACpBsC,GAAY9C,KAAKQ,SAAS6B,GAAMd,IAChCwB,GAAc/C,KAAKQ,SAAS6B,GAAMd,IAAMvB,KAAKQ,SAAS6B,GAAMK,gBAG9DN,GAAQ,kDAA2DE,OAAOQ,EAAU,+EAAuHR,OAAOS,EAAY,4GAAsJT,OAAOS,EAAY,6BACvYlD,EAAE,oBAAoBuC,KAAKA,IAE7BtB,WAAY,WACVd,KAAKmC,gBACLnC,KAAK6C,mBACL7C,KAAK+B,kBAMPa,gBAAiB,WACLpB,OAAO3B,EAAEG,KAAKD,KAAK0B,UAAUC,QAE5B,EACT7B,EAAEG,KAAKD,KAAK8B,WAAWmB,IAAI,CACzBC,OAAQ,gBAGVpD,EAAEG,KAAKD,KAAK8B,WAAWmB,IAAI,CACzBC,OAAQ,eAkDhB,IAAIC,EAAYrD,EAAEsD,YAClBD,EAAUE,IAbV,YA7BA,WACE,IAAIC,EAAWxD,EAAEyD,OAAO,iBAExB,QAAiBC,IAAbF,EAAJ,CAKA,IAAIG,EAAO5C,KAAKK,MAAMoC,GACtBxD,EAAE,aAAauC,KAAKoB,EAAKC,WAqBzBC,GAZA7D,EAAE,eAAewB,GAAG,QAAS,SAAUsC,GACrCA,EAAEC,eAAiBD,EAAEC,iBAAmBD,EAAEE,aAAc,EACxDhE,EAAEiE,aAAa,iBACfC,SAASC,WAWX,IAAIlE,EAAI,CACNG,UAAW,gBACX4B,UAAW,cACXP,OAAQ,WACRG,SAAU,aACVK,UAAW,gBACV1B,SAKL8C,EAAUe,OArLZ,CAsLGC","file":"cars-d09f4a911f.js","sourcesContent":["\"use strict\";\n\n;\n;\n\n(function ($) {\n  /**\r\n   * 购物车对象\r\n   */\n  function Car(eles) {\n    this.eles = eles;\n    this.ordersEle = $(eles.ordersEle);\n  }\n\n  $.extend(Car.prototype, {\n    init: function init() {\n      this.initCars();\n    },\n\n    /**\r\n     * 更新购物车数据\r\n     * @param {*} carData \r\n     */\n    update: function update(carData) {\n      this.carsList[carData.id] = carData;\n      localStorage.setItem(\"cars\", JSON.stringify(this.carsList));\n      this.renderData();\n    },\n    \"delete\": function _delete(productId) {\n      delete this.carsList[productId];\n      localStorage.setItem(\"cars\", JSON.stringify(this.carsList));\n      this.renderData();\n    },\n\n    /**\r\n     * 初始化购物车数据\r\n     */\n    initCars: function initCars() {\n      this.carsList = JSON.parse(localStorage.getItem(\"cars\")) || {};\n      this.renderData();\n      this.bindEvent();\n    },\n    bindEvent: function bindEvent() {\n      var that = this; // 选择数量 加法的\n\n      this.ordersEle.on(\"click\", that.eles.numAdd, function () {\n        // 获取输入框的数字\n        var num = Number($(that.eles.numInput).val()); // 获取这个商品的id好\n\n        var productId = $(this).parents(\"tr\").find(\"input[name=productId]\").val();\n        num++;\n        $(that.eles.numInput).val(num); // 获取这个购物车localStorage中对应的商品数据\n\n        var carData = that.carsList[productId];\n        carData.num = num; // 更新数据\n\n        that.update(carData);\n      }); // 选择数量减法的\n\n      this.ordersEle.on(\"click\", that.eles.numReduce, function () {\n        // 获取输入框中的数据\n        var num = Number($(that.eles.numInput).val()); // 获取这个商品的id值\n\n        var productId = $(this).parents(\"tr\").find(\"input[name=productId]\").val();\n        num--;\n\n        if (num === 0) {\n          return false;\n        }\n\n        $(that.eles.numInput).val(num); // 从新计算数据\n\n        var carData = that.carsList[productId];\n        carData.num = num;\n        that.update(carData);\n      });\n      /**\r\n       * 删除按钮的事件\r\n       */\n\n      this.ordersEle.on(\"click\", that.eles.deleteBtn, function () {\n        var productId = $(this).parents(\"tr\").find(\"input[name=productId]\").val();\n        that[\"delete\"](productId);\n      });\n    },\n    bindImageHover: function bindImageHover() {\n      $(\".product-pic\").hover(function () {\n        $(\".product-pic-preview-tooltips\").addClass(\"product-tooltips-show\");\n      }, function () {\n        $(\".product-pic-preview-tooltips\").removeClass(\"product-tooltips-show\");\n      });\n    },\n    renderCarData: function renderCarData() {\n      var carData = this.carsList;\n      var html = \"\";\n\n      for (var attr in carData) {\n        html += \"<tr class=\\\"goods_item\\\">\\n                <input type=\\\"hidden\\\" name=\\\"productId\\\" value=\\\"\".concat(attr, \"\\\">\\n                <td class=\\\"product-item\\\">\\n                    <div class=\\\"m-product product-small\\\">\\n                        <div class=\\\"product-pic product-pic-trigger\\\">\\n                            <a href=\\\"javascript:void(0)\\\">\\n                                <img width=\\\"58\\\" height=\\\"74\\\"\\n                                    src=\\\"\").concat(carData[attr].images[0], \"\\\"\\n                                    alt=\\\"\\\" />\\n                            </a>\\n                            <div class=\\\"product-pic-preview-tooltips ui-tooltips\\\">\\n                                <div class=\\\"ui-tooltips-content\\\">\\n                                    <img class=\\\"\\\"\\n                                        src=\\\"\").concat(carData[attr].images[0], \"\\\"\\n                                        alt=\\\"\").concat(carData[attr].longTitle, \"\\\" width=\\\"184\\\"\\n                                        height=\\\"234\\\">\\n                                </div>\\n                            </div>\\n                        </div>\\n                        <h3 class=\\\"product-title\\\">\\n                            <span class=\\\"u-saletype u-saletype-0\\\">\\u81EA\\u8425</span>\\n                            <a href=\\\"javascript:void(0)\\\">\").concat(carData[attr].longTitle, \"</a>\\n                        </h3>\\n                        <p class=\\\"product-size\\\">\\u5C3A\\u7801\\uFF1A\").concat(carData[attr].size, \"</p>\\n                        <div class=\\\"product-price-tip\\\">\\n                            <span class=\\\"product-tip\\\">\\u6298\\u540E\\u4EF7</span>\\n                        </div>\\n                    </div>\\n                </td>\\n                <td class=\\\"price-item\\\">\\n                    <div class=\\\"m-price\\\">\\n                        <span class=\\\"goods-cxoprice-tag u-hidden\\\"></span>\\n                        <span class=\\\"u-yen\\\">\\xA5</span><strong class=\\\"u-price\\\">\").concat(carData[attr].promotion_price, \"</strong>\\n                    </div>\\n                    <del class=\\\"m-price market-price\\\">\\n                        <span class=\\\"u-yen\\\">\\xA5</span><span class=\\\"u-price\\\">\").concat(carData[attr].max_market_price, \"</span>\\n                    </del>\\n                </td>\\n                <td class=\\\"quantity-item\\\">\\n                    <div class=\\\"m-amount confirm_box cart_amount_confirm_box clearfix\\\">\\n                        <a class=\\\"iconfont icon-jianhao icon-reduce num-reduce\\\"\\n                            href=\\\"javascript:void(0)\\\">\\n                        </a>\\n                        <div title=\\\"\\u8BF7\\u9009\\u62E9\\u8D2D\\u4E70\\u6570\\u91CF\\\" class=\\\"amount-num\\\">\\n                            <input name=\\\"num\\\" type=\\\"text\\\" disabled value=\\\"\").concat(carData[attr].num, \"\\\"\\n                                class=\\\"cart_num num-input\\\" />\\n                        </div>\\n                        <a class=\\\"iconfont icon-jiahao icon-add num-add\\\"\\n                            href=\\\"javascript:void(0)\\\">\\n                        </a>\\n                    </div>\\n                </td>\\n                <td class=\\\"subtotal-item\\\">\\n                    <span class=\\\"m-price  subtotal-price\\\">\\n                        <span class=\\\"u-yen\\\">\\xA5</span>\\n                        <strong class=\\\"u-price\\\">\\n                            \").concat(carData[attr].promotion_price * carData[attr].num, \"\\n                        </strong>\\n                    </span>\\n                </td>\\n                <td class=\\\"actions-item\\\">\\n                    <a href=\\\"javascript:void(0)\\\" class=\\\"dellCarBtn\\\">\\u5220\\u9664</a>\\n                </td>\\n            </tr>\");\n      }\n\n      this.ordersEle.html(html);\n      this.notAllowedCheck();\n    },\n    renderTotalPrice: function renderTotalPrice() {\n      var html = \"\";\n      var totalNum = 0;\n      var totalPrice = 0;\n\n      for (var attr in this.carsList) {\n        totalNum += this.carsList[attr].num;\n        totalPrice += this.carsList[attr].num * this.carsList[attr].promotion_price;\n      }\n\n      html += \"<p class=\\\"price-panel\\\">\\u5171<span class=\\\"quantity\\\">\".concat(totalNum, \"</span>\\u4EF6\\u5546\\u54C1&nbsp;&nbsp;\\u5546\\u54C1\\u91D1\\u989D<span\\n            class=\\\"m-price\\\"><span>\\xA5</span>\").concat(totalPrice, \"</span></p>\\n            <p class=\\\"price-panel\\\">\\u603B\\u91D1\\u989D(\\u672A\\u542B\\u8FD0\\u8D39)<span class=\\\"m-price totalPrice\\\"><span>\\xA5</span>\").concat(totalPrice, \"</span>\\n            </p>\");\n      $(\".orders-total-bd\").html(html);\n    },\n    renderData: function renderData() {\n      this.renderCarData();\n      this.renderTotalPrice();\n      this.bindImageHover();\n    },\n\n    /**\r\n     * 加减按钮的不允许状态检查\r\n     */\n    notAllowedCheck: function notAllowedCheck() {\n      var num = Number($(this.eles.numInput).val());\n\n      if (num <= 1) {\n        $(this.eles.numReduce).css({\n          cursor: \"not-allowed\"\n        });\n      } else {\n        $(this.eles.numReduce).css({\n          cursor: \"pointer\"\n        });\n      }\n    }\n  });\n  /**\r\n   * 检查登录\r\n   */\n\n  function checkLogin() {\n    var userInfo = $.cookie(\"userLoginInfo\"); // 等于undefined直接结束\n\n    if (userInfo === undefined) {\n      return false;\n    } // 不然我们需要将用户信息放在页面之中 表示已登录\n\n\n    var user = JSON.parse(userInfo);\n    $(\".username\").html(user.username);\n  }\n  /**\r\n   * 退出\r\n   */\n\n\n  function logout() {\n    // 给退出按钮绑定事件\n    $(\".linkLogout\").on(\"click\", function (e) {\n      e.preventDefault ? e.preventDefault() : e.returnValue = false;\n      $.removeCookie(\"userLoginInfo\");\n      location.reload();\n    });\n  }\n  /**\r\n   * 页面初始化函数\r\n   */\n\n\n  function init() {\n    checkLogin();\n    logout();\n    new Car({\n      ordersEle: \".orders-table\",\n      numReduce: \".num-reduce\",\n      numAdd: \".num-add\",\n      numInput: \".num-input\",\n      deleteBtn: \".dellCarBtn\"\n    }).init();\n  }\n\n  var callbacks = $.Callbacks();\n  callbacks.add(init);\n  callbacks.fire();\n})(jQuery);"]}