{"version":3,"sources":["register.js"],"names":["$","callbacks","Callbacks","add","on","toggleClass","val","err_txt","parent","siblings","find","show","hide","one","ipts","index","this","ele","get","html","validator","addMethod","value","element","optional","test","validate","rules","loginName","required","format","pvcode","digits","minlength","password","regPsd","repeatPassword","messages","errorPlacement","error","attr","removeClass","errorText","innerHTML","css","borderColor","children","unhighlight","addClass","click","valid","ajax","url","method","dataType","data","telephone","success","console","log","type","msg","setTimeout","location","href","fire","jQuery"],"mappings":"AAAA,cAKA,SAAWA,GACT,IAAIC,EAAYD,EAAEE,YAClBD,EAAUE,IAMV,WAWEH,EAAE,uBAAuBI,GAAG,QAAS,QAAS,WAC5CJ,EAAE,2BAA2BK,YAAY,eACZ,MAA7BL,EAAE,iBAAiBM,MAAgBN,EAAE,iBAAiBM,IAAI,GAAKN,EAAE,iBAAiBM,IAAI,GACtF,IAAIC,EAAUP,EAAE,iBAAiBQ,SAASA,SAASC,SAAS,gBAAgBC,KAAK,QAEhD,MAA7BV,EAAE,iBAAiBM,MACrBC,EAAQI,OAERJ,EAAQK,SAIZZ,EAAE,uBAAuBa,IAAI,QAAS,QAAS,WAC7C,IAAIC,EAAOd,EAAE,6BACTe,EAAQD,EAAKC,MAAMf,EAAEgB,OACrBC,EAAMjB,EAAEc,EAAKI,IAAIH,IAAQP,SAASC,WAAWC,KAAK,QAAQC,OAE9D,OAAQI,GACN,KAAK,EACHE,EAAIE,KAAK,mBAiHfnB,EAAEoB,UAAUC,UAAU,SAAU,SAAUC,EAAOC,GAE/C,OAAOP,KAAKQ,SAASD,IADL,2EAC2BE,KAAKH,IAC/C,cACHtB,EAAEoB,UAAUC,UAAU,SAAU,SAAUC,EAAOC,GAE/C,OAAOP,KAAKQ,SAASD,IADR,4CAC2BE,KAAKH,IAC5C,+BA5GHtB,EAAE,aAAa0B,SAAS,CACtBC,MAAO,CACLC,UAAW,CACTC,UAAU,EACVC,QAAQ,GAEVC,OAAQ,CACNF,UAAU,EACVG,QAAQ,EACRC,UAAW,GAEbC,SAAU,CACRL,UAAU,EACVM,QAAQ,GAEVC,eAAgB,CACdP,UAAU,IAGdQ,SAAU,CACRT,UAAW,CACTC,SAAU,YAEZK,SAAU,CACRL,SAAU,UAEZE,OAAQ,CACNF,SAAU,eACVG,OAAQ,eACRC,UAAW,gBAEbG,eAAgB,CACdP,SAAU,YAGdS,eAAgB,SAAwBC,EAAOhB,GACP,SAAlCvB,EAAEuB,GAASiB,KAAK,eAClBxC,EAAE,0BAA0ByC,YAAY,kBAG1C,IAAIC,EAAYH,EAAM,GAAGI,UACzBpB,EAAQqB,IAAI,CACVC,YAAa,YAEftB,EAAQd,SAAS,eAAeE,OAChCY,EAAQd,SAAS,iBAAiBG,OAClCW,EAAQf,SAASC,SAAS,gBAAgBqC,SAAS,QAAQnC,OAAOQ,KAAKuB,IAEzEK,YAAa,SAAqBxB,GAEM,SAAlCvB,EAAEuB,GAASiB,KAAK,eAClBxC,EAAE,0BAA0BgD,SAAS,kBAGvChD,EAAEuB,GAASqB,IAAI,CACbC,YAAa,YAEf7C,EAAEuB,GAASd,SAAS,eAAeG,OACnCZ,EAAEuB,GAASd,SAAS,iBAAiBE,OACrCX,EAAEuB,GAASf,SAASC,SAAS,gBAAgBqC,SAAS,QAAQlC,UAIlEZ,EAAE,mBAAmBiD,MAAM,WAGzB,IAFgBjD,EAAE,aAAakD,QAG7B,OAAO,EAITlD,EAAEmD,KAAK,CACLC,IAAK,6CACLC,OAAQ,OACRC,SAAU,OACVC,KAAM,CACJC,UAAWxD,EAAE,gBAAgBM,MAC7B4B,SAAUlC,EAAE,aAAaM,OAE3BmD,QAAS,SAAiBF,GACxBG,QAAQC,IAAIJ,GAEM,YAAdA,EAAKK,MACP5D,EAAE,sBAAsBmB,KAAKoC,EAAKM,KAAKpB,YAAY,SAASO,SAAS,WAAWxC,SAASiC,YAAY,UAErGqB,WAAW,WACTC,SAASC,KAAO,eACf,MAEHhE,EAAE,sBAAsBmB,KAAKoC,EAAKM,KAAKpB,YAAY,WAAWO,SAAS,SAASxC,SAASiC,YAAY,iBAxI/GxC,EAAUgE,OAHZ,CAgKGC","file":"register-def679905d.js","sourcesContent":["\"use strict\";\n\n;\n;\n\n(function ($) {\n  var callbacks = $.Callbacks();\n  callbacks.add(init);\n  callbacks.fire();\n  /**\r\n   * 初始化函数\r\n   */\n\n  function init() {\n    bindEvent();\n    formValidate();\n  }\n  /**\r\n   * 给表单元素绑定事件\r\n   */\n\n\n  function bindEvent() {\n    // 我已同意的checkbox的点击事件\n    $(\".ui-form-item-group\").on(\"click\", \"label\", function () {\n      $(\".ui-checkbox-simulation\").toggleClass(\"check-agree\");\n      $(\"#mobile_agree\").val() === \"1\" ? $(\"#mobile_agree\").val(0) : $(\"#mobile_agree\").val(1);\n      var err_txt = $(\"#mobile_agree\").parent().parent().siblings(\".u-input-tip\").find(\".txt\");\n\n      if ($(\"#mobile_agree\").val() === \"0\") {\n        err_txt.show();\n      } else {\n        err_txt.hide();\n      }\n    }); // 每一个表单focus的时候需要提示信息\n\n    $(\".ui-form-item-group\").one(\"focus\", \"input\", function () {\n      var ipts = $(\".ui-form-item-group input\");\n      var index = ipts.index($(this));\n      var ele = $(ipts.get(index)).parent().siblings().find(\".txt\").show();\n\n      switch (index) {\n        case 0:\n          ele.html(\"请输入您的11位手机号码\");\n          break;\n      }\n    });\n  }\n  /**\r\n   * 表单格式验证\r\n   */\n\n\n  function formValidate() {\n    customValidate();\n    $(\"#reg_form\").validate({\n      rules: {\n        loginName: {\n          required: true,\n          format: true\n        },\n        pvcode: {\n          required: true,\n          digits: true,\n          minlength: 6\n        },\n        password: {\n          required: true,\n          regPsd: true\n        },\n        repeatPassword: {\n          required: true\n        }\n      },\n      messages: {\n        loginName: {\n          required: \"手机号码不能为空\"\n        },\n        password: {\n          required: \"密码不能为空\"\n        },\n        pvcode: {\n          required: \"请输入6位数字手机验证码\",\n          digits: \"请输入6位数字手机验证码\",\n          minlength: \"请输入6位数字手机验证码\"\n        },\n        repeatPassword: {\n          required: \"请输入确认密码\"\n        }\n      },\n      errorPlacement: function errorPlacement(error, element) {\n        if ($(element).attr(\"data-value\") === \"手机号码\") {\n          $(\"#mobile_verifycode_btn\").removeClass(\"mobile-success\");\n        }\n\n        var errorText = error[0].innerHTML;\n        element.css({\n          borderColor: \"#f64a4a\"\n        });\n        element.siblings(\".icon-error\").show();\n        element.siblings(\".icon-success\").hide();\n        element.parent().siblings(\".u-input-tip\").children(\"span\").show().html(errorText);\n      },\n      unhighlight: function unhighlight(element, errorClass, validClass) {\n        // 判断是否为书籍元素节点\n        if ($(element).attr(\"data-value\") === \"手机号码\") {\n          $(\"#mobile_verifycode_btn\").addClass(\"mobile-success\");\n        }\n\n        $(element).css({\n          borderColor: \"#d2c2d2\"\n        });\n        $(element).siblings(\".icon-error\").hide();\n        $(element).siblings(\".icon-success\").show();\n        $(element).parent().siblings(\".u-input-tip\").children(\"span\").hide();\n      }\n    }); // 表单提交的时候也需要验证一次\n\n    $(\"#mobile-reg-btn\").click(function () {\n      var isChecked = $(\"#reg_form\").valid();\n\n      if (!isChecked) {\n        return false;\n      } // 如果验证成功我们就发送ajax请求\n\n\n      $.ajax({\n        url: \"http://xfy196.qicp.vip/vipPhp/register.php\",\n        method: \"POST\",\n        dataType: \"json\",\n        data: {\n          telephone: $(\"#mobile_name\").val(),\n          password: $(\"#password\").val()\n        },\n        success: function success(data) {\n          console.log(data); // 注册成功，提示用户然后跳转登录页面\n\n          if (data.type === \"success\") {\n            $(\".register_msg .msg\").html(data.msg).removeClass(\"error\").addClass(\"success\").parent().removeClass(\"hidden\"); // 一秒中之后跳转登录页面\n\n            setTimeout(function () {\n              location.href = \"/login.html\";\n            }, 2000);\n          } else {\n            $(\".register_msg .msg\").html(data.msg).removeClass(\"success\").addClass(\"error\").parent().removeClass(\"hidden\");\n          }\n        }\n      });\n    });\n  }\n  /**\r\n  * 自定义邮箱，手机号码的正则验证\r\n  */\n\n\n  function customValidate() {\n    $.validator.addMethod(\"format\", function (value, element) {\n      var regMobile = /^((13[0-9])|(14[5,7])|(15[0-3,5-9])|(17[0,3,5-8])|(18[0-9])|(147))\\d{8}$/;\n      return this.optional(element) || regMobile.test(value);\n    }, \"请输入正确的手机号码\");\n    $.validator.addMethod(\"regPsd\", function (value, element) {\n      var regPsd = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)[^]{8,16}$/;\n      return this.optional(element) || regPsd.test(value);\n    }, \"密码由6-20位字母，数字和符号组合,至少一位大写字母\");\n  }\n})(jQuery);"]}